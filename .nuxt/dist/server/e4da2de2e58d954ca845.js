exports.ids=[1],exports.modules={86:function(t,e,o){"use strict";var l=o(4),r=o.n(l),n={async post(t,data){t="http://127.0.0.1:10012"+t,console.log("axios url: ",t);let e=await r.a.post(t,data);return console.log("axios status: ",e.status),e.data}};e.a={getTemplates:async()=>await n.post("/api/templates"),getTemplateInfo:async(data={})=>await n.post("/api/template/info",{name:data.name}),getCategoryData:async(data={})=>await n.post("/api/website/info/getDataList",{category:data.category}),getDocumentData:async(data={})=>await n.post("/api/website/info/getDataList",{category:"document",type:data.type||"config",page:data.page||1,limit:data.limit||0,pid:data.pid}),websiteDataCreate:async(data={})=>await n.post("/api/website/admin/dataCreate",data),websiteDataUpdate:async(data={})=>await n.post("/api/website/admin/dataUpdate",data)}},88:function(t,e,o){"use strict";o.r(e);var l=o(86),r={components:{},data:()=>({pageID:0,dataConfigId:0,dataConfigValue:"",dialogVisibleBanner:!1,dialogVisibleConfig:!1,dialogVisibleArticle:!1,formItemConfig:{},formItemBanner:{},formItemArticle:{},formRulesArticle:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:1,max:32,message:"长度在 1 到 32 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"}],document_category:[{required:!0,message:"请输入分类",trigger:"blur"}]}}),async fetch({store:t,route:e,params:o}){console.log("fetch route:",e);let r=e.query||{},n=r.id||0,template=r.template||"";""===template&&(template="index");let c=await l.a.getTemplateInfo({name:template});console.log("getch getTemplateInfo templateInfoRet:",c),t.commit("templateInfoSet",c.data);let m=c.data;if(!n){let t=await l.a.getCategoryData({category:"index"});if(console.log("getch categoryRet ret:",t),t.data&&0==t.data.count){let t=await l.a.websiteDataCreate({name:"index",title:"首页",category:"index"});console.log("getch categoryIndexCreateRet:",t),n=t.data.id}else n=t.data.rows[0].id}if(console.log("getch pid",n),t.commit("dataPidSet",n),m.configs&&m.configs.length){let e=await l.a.getDocumentData({pid:n,type:"config"});console.log("getch configsDataRet:",e);let o=e.data.rows;t.commit("dataConfigsSet",o)}let d=await l.a.getDocumentData({pid:n,type:"banner"});console.log("getch bannerssDataRet:",d);let f=d.data.rows;t.commit("dataBannnersSet",f);let v=await l.a.getDocumentData({pid:n,type:"article",page:1,limit:10});console.log("getch articlesDataRet:",v);let h=v.data.rows||[],y={page:1,limit:10,total:v.data.count};t.commit("dataArticlesSet",h),t.commit("dataArticlesPaginationSet",y),t.commit("subNavIndexSet","2")},methods:{...o(30).a,bannerModify(data={}){let t={};t.id=data.id||0,t.cover=data.cover||"",t.thumb=data.thumb||"",t.content=data.content||"",t.url=data.url||"",t.sort=data.sort||0,t.document_category=data.document_category||"",this.formItemBanner=t,this.dialogVisibleBanner=!0},async bannerDataStatusUpdate(data,t=1){let e={};e=Object.assign({},e,data),console.log("bannerDataStatusUpdate bannerData",e),e.status=t,console.log("bannerDataStatusUpdate bannerData",e);let o=await l.a.websiteDataUpdate(e);console.log("bannerDataStatusUpdate updateRet",o),0==o.code?await this.bannerDataReload():this.$message.error(o.message||"error")},async bannerDataReload(){let t=await l.a.getDocumentData({pid:this.$store.state.dataPid,type:"banner"});console.log("getch bannerssDataRet:",t);let e=t.data.rows;this.$store.commit("dataBannnersSet",e)},async bannerDataUpdate(t=1){let e,o=this.formItemBanner;o.pid=this.$store.state.dataPid,o.category="document",o.document_type="banner",o.name="banner_"+Date.now(),o.title="banner_"+Date.now(),o.status=t,console.log("methods bannerDataUpdate data:",o),e=o.id?await l.a.websiteDataUpdate(o):await l.a.websiteDataCreate(o),console.log("methods bannerDataUpdate updateRet:",e),0==e.code?(await this.bannerDataReload(),this.dialogVisibleBanner=!1):this.$message.error(e.message||"error")},configModify(data={}){this.formItemConfig=data;let t=this.$store.state.dataConfigs;t.hasOwnProperty(data.name)?(this.dataConfigId=t[data.name].id,this.dataConfigValue=t[data.name].value):(this.dataConfigId=0,this.dataConfigValue=""),this.dialogVisibleConfig=!0},async configDataReload(){let t=await l.a.getDocumentData({pid:this.$store.state.dataPid,type:"config"});console.log("getch configsDataRet:",t);let e=t.data.rows;this.$store.commit("dataConfigsSet",e)},async configDataUpdate(){let t,e={};e.id=this.dataConfigId,e.pid=this.$store.state.dataPid,e.category="document",e.name=this.formItemConfig.name,e.title=this.formItemConfig.title,e.document_type="config",e.content=this.dataConfigValue,e.status=1,console.log("methods configDataUpdate configData:",e),0==(t=e.id?await l.a.websiteDataUpdate(e):await l.a.websiteDataCreate(e)).code?(await this.configDataReload(),this.dialogVisibleConfig=!1):this.$message.error(t.message||"error")},articleModify(data={}){let t={};t.id=data.id||0,t.title=data.title||"",t.name=data.name||"",t.description=data.description||"",t.document_category=data.document_category||"",t.content=data.content||"",t.post_time=data.post_time||0,t.sort=data.sort||0,this.formItemArticle=t,this.dialogVisibleArticle=!0},async articleUpdate(){let t=this.formItemArticle;t.category="document",t.document_type="article",t.name=t.title,t.pid=this.$store.state.dataPid;let e,o=await this.formValidata("formArticle");console.log("articlesUpdate valid:",o),o&&(console.log("articleUpdate articleData:",t),e=t.id?await l.a.websiteDataUpdate(t):await l.a.websiteDataCreate(t),console.log("articleUpdate updateRet:",e),0==e.code?(await this.articleDataReload(),this.dialogVisibleArticle=!1):this.$message.error(e.message||"error"))},async articleDataReload(){let t=this.$store.state.dataArticlesPagination.page,e=this.$store.state.dataArticlesPagination.limit,o=await l.a.getDocumentData({pid:this.$store.state.dataPid,type:"article",page:t,limit:e});console.log("articleDataReload articlesDataRet:",o);let r=o.data.rows||[],n={page:t,limit:e,total:o.data.count};this.$store.commit("dataArticlesSet",r),this.$store.commit("dataArticlesPaginationSet",n)},async articleDataStatusUpdate(data,t=1){let e={};e=Object.assign({},e,data),console.log("articleDataStatusUpdate articleData",e),e.status=t,console.log("articleDataStatusUpdate articleData",e);let o=await l.a.websiteDataUpdate(e);console.log("articleDataStatusUpdate updateRet",o),0==o.code?await this.articleDataReload():this.$message.error(o.message||"error")},formValidata(t){let e=this.$refs[t];return new Promise((t,o)=>{e.validate(e=>{t(!!e)})})}}},n=o(5);var component=Object(n.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[t.$store.state.templateInfo.configs&&t.$store.state.templateInfo.configs.length?o("el-card",{staticClass:"mt-4"},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticClass:"text-2xl"},[t._v("配置内容(Config)")])]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.$store.state.templateInfo.configs}},[o("el-table-column",{attrs:{prop:"title",label:"配置名称",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{prop:"type",label:"配置类型",width:"180"}}),t._v(" "),o("el-table-column",{attrs:{label:"配置数据"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$store.state.dataConfigs.hasOwnProperty(e.row.name)?[t._v(t._s(t.$store.state.dataConfigs[e.row.name].value))]:[t._v("-")]]}}],null,!1,3254011707)}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.configModify(e.row)}}},[t._v("编辑 / 查看")])]}}],null,!1,2555892300)})],1)],1):t._e(),t._ssrNode(" "),o("el-card",{staticClass:"mt-4"},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticClass:"text-2xl"},[t._v("广告横幅(Banner)")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.bannerModify}},[t._v("添加图片")])],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.$store.state.dataBanners}},[o("el-table-column",{attrs:{label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){return[o("img",{staticStyle:{height:"60px"},attrs:{src:t.row.thumb||t.row.cover,alt:""}})]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"排序",prop:"sort"}}),t._v(" "),o("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?o("el-switch",{attrs:{value:!0,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(o){return t.bannerDataStatusUpdate(e.row,0)}}}):t._e(),t._v(" "),0==e.row.status?o("el-switch",{attrs:{value:!1,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(o){return t.bannerDataStatusUpdate(e.row,1)}}}):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.bannerModify(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(o){return t.bannerDataStatusUpdate(e.row,-1)}}},[t._v("删除")])]}}])})],1)],1),t._ssrNode(" "),t.$store.state.templateInfo.articles&&t.$store.state.templateInfo.articles.length?o("el-card",{staticClass:"mt-4"},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",{staticClass:"text-2xl"},[t._v("文档数据(Article)")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.articleModify}},[t._v("添加文档")])],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.$store.state.dataArticles}},[o("el-table-column",{attrs:{prop:"title",label:"标题"}}),t._v(" "),o("el-table-column",{attrs:{label:"添加时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.dateFormat(e.row.create_time)))]}}],null,!1,3863569317)}),t._v(" "),o("el-table-column",{attrs:{label:"排序",prop:"sort"}}),t._v(" "),o("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?o("el-switch",{attrs:{value:!0,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(o){return t.articleDataStatusUpdate(e.row,0)}}}):t._e(),t._v(" "),0==e.row.status?o("el-switch",{attrs:{value:!1,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(o){return t.articleDataStatusUpdate(e.row,1)}}}):t._e()]}}],null,!1,1447137947)}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.articleModify(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(o){return t.articleDataStatusUpdate(e.row,-1)}}},[t._v("删除")])]}}],null,!1,4166871665)})],1),t._v(" "),o("el-pagination",{staticClass:"mt-4",attrs:{"current-page":t.$store.state.dataArticlesPagination.page,"page-size":t.$store.state.dataArticlesPagination.limit,layout:"prev, pager, next, total, jumper",total:t.$store.state.dataArticlesPagination.total}})],1):t._e(),t._ssrNode(" "),o("el-dialog",{attrs:{title:"图片添加/编辑",visible:t.dialogVisibleBanner,width:"60%"},on:{"update:visible":function(e){t.dialogVisibleBanner=e}}},[o("el-form",{attrs:{"label-width":"100px"}},[o("el-form-item",{attrs:{label:"图片"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.formItemBanner.cover,callback:function(e){t.$set(t.formItemBanner,"cover",e)},expression:"formItemBanner.cover"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"缩略图"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.formItemBanner.thumb,callback:function(e){t.$set(t.formItemBanner,"thumb",e)},expression:"formItemBanner.thumb"}})],1),t._v(" "),t.$store.state.templateInfo.banners&&t.$store.state.templateInfo.banners.length?o("el-form-item",{attrs:{label:"分类"}},[t._l(t.$store.state.templateInfo.banners,(function(e){return[o("el-radio",{attrs:{label:e.name},model:{value:t.formItemBanner.document_category,callback:function(e){t.$set(t.formItemBanner,"document_category",e)},expression:"formItemBanner.document_category"}},[t._v(t._s(e.title))])]}))],2):t._e(),t._v(" "),o("el-form-item",{attrs:{label:"图片说明"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.formItemBanner.content,callback:function(e){t.$set(t.formItemBanner,"content",e)},expression:"formItemBanner.content"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"点击跳转url"}},[o("el-input",{attrs:{placeholder:"请输入内容跳转url"},model:{value:t.formItemBanner.url,callback:function(e){t.$set(t.formItemBanner,"url",e)},expression:"formItemBanner.url"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"排序"}},[o("el-input-number",{attrs:{min:0,max:1e4,placeholder:"越小越优先"},model:{value:t.formItemBanner.sort,callback:function(e){t.$set(t.formItemBanner,"sort",e)},expression:"formItemBanner.sort"}})],1)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisibleBanner=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.bannerDataUpdate}},[t._v("确 定")])],1)],1),t._ssrNode(" "),o("el-dialog",{attrs:{title:"配置信息设置",visible:t.dialogVisibleConfig,width:"60%"},on:{"update:visible":function(e){t.dialogVisibleConfig=e}}},[o("el-form",{ref:"formConfig",attrs:{"label-width":"100px"}},[o("el-form-item",{attrs:{label:"配置项目"}},[o("el-input",{attrs:{placeholder:t.formItemConfig.title,disabled:!0}})],1),t._v(" "),o("el-form-item",{attrs:{label:"配置类型"}},[o("el-input",{attrs:{placeholder:t.formItemConfig.type,disabled:!0}})],1),t._v(" "),o("el-form-item",{attrs:{label:"配置数据"}},["text"==t.formItemConfig.type?[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.dataConfigValue,callback:function(e){t.dataConfigValue=e},expression:"dataConfigValue"}})]:t._e(),t._v(" "),"img"==t.formItemConfig.type?[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.dataConfigValue,callback:function(e){t.dataConfigValue=e},expression:"dataConfigValue"}})]:t._e()],2)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.formItemConfig.id,expression:"formItemConfig.id"}],attrs:{type:"hidden"},domProps:{value:t.formItemConfig.id},on:{input:function(e){e.target.composing||t.$set(t.formItemConfig,"id",e.target.value)}}}),t._v(" "),o("el-button",{on:{click:function(e){t.dialogVisibleConfig=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.configDataUpdate}},[t._v("确 定")])],1)],1),t._ssrNode(" "),o("el-dialog",{attrs:{title:"文档添加/编辑",visible:t.dialogVisibleArticle,width:"60%"},on:{"update:visible":function(e){t.dialogVisibleArticle=e}}},[o("el-form",{ref:"formArticle",attrs:{"label-width":"100px",rules:t.formRulesArticle,model:t.formItemArticle}},[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.formItemArticle.title,callback:function(e){t.$set(t.formItemArticle,"title",e)},expression:"formItemArticle.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分类",prop:"document_category"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formItemArticle.document_category,callback:function(e){t.$set(t.formItemArticle,"document_category",e)},expression:"formItemArticle.document_category"}},t._l(t.$store.state.templateInfo.articles,(function(t){return o("el-option",{key:t.name,attrs:{label:t.title,value:t.name}})})),1)],1),t._v(" "),o("el-form-item",{attrs:{label:"简述"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入简述"},model:{value:t.formItemArticle.description,callback:function(e){t.$set(t.formItemArticle,"description",e)},expression:"formItemArticle.description"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"内容",prop:"content"}},[o("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:t.formItemArticle.content,callback:function(e){t.$set(t.formItemArticle,"content",e)},expression:"formItemArticle.content"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"排序"}},[o("el-input-number",{attrs:{min:0,max:1e4,placeholder:"越小越优先"},model:{value:t.formItemArticle.sort,callback:function(e){t.$set(t.formItemArticle,"sort",e)},expression:"formItemArticle.sort"}})],1)],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.formItemArticle.id,expression:"formItemArticle.id"}],attrs:{type:"hidden"},domProps:{value:t.formItemArticle.id},on:{input:function(e){e.target.composing||t.$set(t.formItemArticle,"id",e.target.value)}}}),t._v(" "),o("el-button",{on:{click:function(e){t.dialogVisibleArticle=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:t.articleUpdate}},[t._v("确 定")])],1)],1)],2)}),[],!1,(function(t){}),null,"60e71f40");e.default=component.exports}};