(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{443:function(e,t,r){"use strict";r(57),r(31);var o,n,l,c,d,m,f,y=r(4),v=r(28),h=r.n(v),_={post:(o=Object(y.a)(regeneratorRuntime.mark((function e(t,data){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("axios node_env:","production"),r="http://adminWebsite.demo.jianpiane.com",console.log("axios domain:",r),t=r+t,console.log("axios url: ",t),e.next=7,h.a.post(t,data);case 7:return o=e.sent,console.log("axios status: ",o.status),e.abrupt("return",o.data);case 10:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})};t.a={getTemplates:(f=Object(y.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.post("/api/templates");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)}),getTemplateInfo:(m=Object(y.a)(regeneratorRuntime.mark((function e(){var data,t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,_.post("/api/template/info",{name:data.name});case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)}),getCategoryData:(d=Object(y.a)(regeneratorRuntime.mark((function e(){var data,t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,_.post("/api/website/info/getDataList",{category:data.category});case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)}),getDocumentData:(c=Object(y.a)(regeneratorRuntime.mark((function e(){var data,t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,_.post("/api/website/info/getDataList",{category:"document",type:data.type||"config",page:data.page||1,limit:data.limit||0,pid:data.pid});case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)}),websiteDataCreate:(l=Object(y.a)(regeneratorRuntime.mark((function e(){var data,t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,_.post("/api/website/admin/dataCreate",data);case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),websiteDataUpdate:(n=Object(y.a)(regeneratorRuntime.mark((function e(){var data,t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,_.post("/api/website/admin/dataUpdate",data);case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}},445:function(e,t,r){"use strict";r.r(t);r(21),r(12),r(58),r(57),r(31);var o,n,l,c,d=r(4),m=r(443),f={data:function(){return{dialogVisible:!1,redirectValue:[0,1],formRules:{title:[{required:!0,message:"请输入栏目标题",trigger:"blur"},{min:1,max:8,message:"长度在 1 到 8 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入栏目标识",trigger:"blur"},{min:1,max:16,message:"长度在 1 到 16 个字符",trigger:"blur"}]},categoryData:{id:0,pid:0,name:"",title:"",description:"",sort:0,seo_title:"",seo_keywords:"",seo_description:"",template:"",template_article:"",page_limit:0,is_redirect:0},categorys:[],templatesCategory:[],templatesArticle:[]}},computed:{},fetch:(c=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.store,t.params,e.next=3,m.a.getCategoryData({category:"category"});case 3:return o=e.sent,console.log("fetch getCategoryData categoryRet:",o),r.commit("categorysSet",o.data.rows||[]),e.next=8,m.a.getTemplates();case 8:n=e.sent,console.log("fetch getTemplates templatesRet:",n),r.commit("templatesSet",n.data),r.commit("subNavIndexSet","1");case 12:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)}),methods:{initPidCategorys:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.$store.state.categorys;this.categorys=[{id:0,name:"",title:"顶级栏目",html:""}],r.forEach((function(r){var data={id:r.id,name:r.name,title:r.title,html:r.html};r.id===t&&0!==t&&(data.disabled=!0),e.categorys.push(data)}))},categoryAddBtnClick:function(){var e=this.$store.state.templates;console.log("methods categoryAddBtnClick templates:",e),this.templatesCategory=e.category,this.templatesArticle=e.article,this.initPidCategorys(),this.categoryData={id:0,pid:"",name:"",title:"",description:"",sort:0,seo_title:"",seo_keywords:"",seo_description:"",template:"",template_article:"",status:1,page_limit:0,is_redirect:0},this.dialogVisible=!0},categoryUpdateBtnClick:function(data){var e=this;console.log("ethods categoryUpdateBtnClick data:",data),Object.keys(this.categoryData).forEach((function(t){data.hasOwnProperty(t)&&(e.categoryData[t]=data[t])}));var t=this.$store.state.templates;console.log("methods categoryUpdateBtnClick templates:",t),this.templatesCategory=t.category,this.templatesArticle=t.article,this.initPidCategorys(data.id),this.dialogVisible=!0},categroyUpdate:(l=Object(d.a)(regeneratorRuntime.mark((function e(){var t,r,o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.categoryData).category="category",console.log("categroyUpdate categoryData:",t),e.next=5,this.formValidata("formCategory");case 5:if(r=e.sent,console.log("categroyUpdate valid:",r),r){e.next=9;break}return e.abrupt("return");case 9:if(!t.id){e.next=23;break}return e.next=12,m.a.websiteDataUpdate(t);case 12:if(o=e.sent,console.log("methods categroyUpdate websiteDataUpdate ret: ",o),0!==o.code){e.next=20;break}return e.next=17,this.categorysReload();case 17:this.dialogVisible=!1,e.next=21;break;case 20:this.$message.error(o.message||"error");case 21:e.next=34;break;case 23:return e.next=25,m.a.websiteDataCreate(t);case 25:if(n=e.sent,console.log("methods categroyUpdate websiteDataCreate ret: ",n),0!==n.code){e.next=33;break}return e.next=30,this.categorysReload();case 30:this.dialogVisible=!1,e.next=34;break;case 33:this.$message.error(n.message||"error");case 34:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)}),categorysReload:(n=Object(d.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.getCategoryData({category:"category"});case 2:return t=e.sent,console.log("method getCategoryData ret:",t),e.next=6,this.$store.commit("categorysSet",t.data.rows||[]);case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),formValidata:function(e){var t=this.$refs[e];return new Promise((function(e,r){t.validate((function(t){e(!!t)}))}))},categoryStatusUpdate:(o=Object(d.a)(regeneratorRuntime.mark((function e(data){var t,r,o,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>1&&void 0!==n[1]?n[1]:0,r={},(r=Object.assign({},r,data)).status=t,e.next=6,m.a.websiteDataUpdate(r);case 6:if(o=e.sent,console.log("methods categoryStatusUpdate websiteDataUpdate ret: ",o),0!==o.code){e.next=13;break}return e.next=11,this.categorysReload();case 11:e.next=14;break;case 13:this.$message.error(o.message||"error");case 14:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})}},y=r(40),component=Object(y.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"text-4xl p-4 border-b"},[e._v("\n    网站栏目\n    "),r("el-button",{staticClass:"float-right",attrs:{type:"primary",size:"small"},on:{click:e.categoryAddBtnClick}},[e._v("添加栏目")])],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.$store.state.categorys,stripe:""}},[r("el-table-column",{attrs:{label:"栏目标题",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.html)+e._s(t.row.title))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"标识"}}),e._v(" "),r("el-table-column",{attrs:{prop:"url",label:"URL"}}),e._v(" "),r("el-table-column",{attrs:{label:"页面模板",prop:"template"}}),e._v(" "),r("el-table-column",{attrs:{label:"跳转"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.is_redirect?[e._v("✔️")]:e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"sort",label:"排序",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"状态",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?r("el-switch",{attrs:{value:!0,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(r){return e.categoryStatusUpdate(t.row,0)}}}):e._e(),e._v(" "),0==t.row.status?r("el-switch",{attrs:{value:!1,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"正常","inactive-text":"禁用"},on:{change:function(r){return e.categoryStatusUpdate(t.row,1)}}}):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.categoryUpdateBtnClick(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.categoryStatusUpdate(t.row,-1)}}},[e._v("删除")])]}}])}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.template&&1!=t.row.is_redirect?[r("router-link",{staticClass:"text-blue-500",attrs:{to:{path:"/data",query:{id:t.row.id,template:t.row.template}}}},[e._v("栏目数据")])]:e._e()]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"formCategory",attrs:{"label-width":"120px",model:e.categoryData,rules:e.formRules}},[r("el-form-item",{attrs:{label:"上级栏目"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.categoryData.pid,callback:function(t){e.$set(e.categoryData,"pid",t)},expression:"categoryData.pid"}},e._l(e.categorys,(function(e){return r("el-option",{key:e.id,attrs:{label:e.html+e.title,value:e.id,disabled:e.disabled}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入栏目标题"},model:{value:e.categoryData.title,callback:function(t){e.$set(e.categoryData,"title",t)},expression:"categoryData.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目标题",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入栏目标识"},model:{value:e.categoryData.name,callback:function(t){e.$set(e.categoryData,"name",t)},expression:"categoryData.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目简述/副标题"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"栏目简述 or 副标题"},model:{value:e.categoryData.description,callback:function(t){e.$set(e.categoryData,"description",t)},expression:"categoryData.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目排序"}},[r("el-input-number",{attrs:{min:0,max:1e4,placeholder:"越小越优先"},model:{value:e.categoryData.sort,callback:function(t){e.$set(e.categoryData,"sort",t)},expression:"categoryData.sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否跳转下一级"}},[r("el-radio",{attrs:{label:e.redirectValue[0]},model:{value:e.categoryData.is_redirect,callback:function(t){e.$set(e.categoryData,"is_redirect",t)},expression:"categoryData.is_redirect"}},[e._v("否")]),e._v(" "),r("el-radio",{attrs:{label:e.redirectValue[1]},model:{value:e.categoryData.is_redirect,callback:function(t){e.$set(e.categoryData,"is_redirect",t)},expression:"categoryData.is_redirect"}},[e._v("是")])],1),e._v(" "),r("el-divider"),e._v(" "),r("el-form-item",{attrs:{label:"栏目SEO标题"}},[r("el-input",{attrs:{placeholder:"请输入栏目SEO标题,默认使用标题"},model:{value:e.categoryData.seo_title,callback:function(t){e.$set(e.categoryData,"seo_title",t)},expression:"categoryData.seo_title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目SEO关键字"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入栏目SEO关键字"},model:{value:e.categoryData.seo_keyword,callback:function(t){e.$set(e.categoryData,"seo_keyword",t)},expression:"categoryData.seo_keyword"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"栏目SEO描述"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入栏目SEO描述，默认使用栏目简述"},model:{value:e.categoryData.seo_description,callback:function(t){e.$set(e.categoryData,"seo_description",t)},expression:"categoryData.seo_description"}})],1),e._v(" "),r("el-divider"),e._v(" "),r("el-form-item",{attrs:{label:"栏目页模板"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.categoryData.template,callback:function(t){e.$set(e.categoryData,"template",t)},expression:"categoryData.template"}},e._l(e.templatesCategory,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"详情页模板"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.categoryData.template_article,callback:function(t){e.$set(e.categoryData,"template_article",t)},expression:"categoryData.template_article"}},e._l(e.templatesArticle,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"文章分页数目"}},[r("el-input-number",{attrs:{min:0,max:100,placeholder:"0为不分页"},model:{value:e.categoryData.page_limit,callback:function(t){e.$set(e.categoryData,"page_limit",t)},expression:"categoryData.page_limit"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.categroyUpdate}},[e._v("确 定")])],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);